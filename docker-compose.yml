# [최종 수정] docker-compose.yml

services:
  # 1. Node.js 서비스 정의
  nodejs-app:
    container_name: attention-nodejs
    image: hwengdeong/attention-app:latest
    ports:
      - "3000:3000"
    restart: always
    networks:
      - attention-network
    environment:
      - REDIS_HOST=redis
      - REDIS_PORT=6379

  # 2. Redis 서비스 정의
  redis:
    container_name: attention-redis
    image: "redis:alpine"
    restart: always
    networks:
      - attention-network

  # 3. 데이터 저장 서비스 (Python)
  session-data-saver:
    container_name: attention-data-saver
    build:
      context: ./sessionDataSave
      dockerfile: Dockerfile
    restart: always
    networks:
      - attention-network
    environment:
      - REDIS_HOST=redis
      - REDIS_PORT=6379
    volumes:
      - ./data_storage:/app/saved_data


networks:
  attention-network:
    driver: bridge